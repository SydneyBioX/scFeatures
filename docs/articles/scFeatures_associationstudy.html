<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="scFeatures">
<title>An association study of features with conditions with scFeatures â€¢ scFeatures</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An association study of features with conditions with scFeatures">
<meta property="og:description" content="scFeatures">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">scFeatures</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/scFeatures_associationstudy.html">An association study of features with conditions with scFeatures</a>
    <a class="dropdown-item" href="../articles/scFeatures_detail.html">A detailed explanation of scFeatures' features</a>
    <a class="dropdown-item" href="../articles/scFeatures_summary.html">An overview of scFeatures' functions</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SydneyBioX/scFeatures/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>An association study of features with conditions with scFeatures</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SydneyBioX/scFeatures/blob/HEAD/vignettes/scFeatures_associationstudy.Rmd" class="external-link"><code>vignettes/scFeatures_associationstudy.Rmd</code></a></small>
      <div class="d-none name"><code>scFeatures_associationstudy.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="association-study-of-the-features-with-the-conditions">Association study of the features with the conditions<a class="anchor" aria-label="anchor" href="#association-study-of-the-features-with-the-conditions"></a>
</h2>
<p>scFeatures provides a function that automatically run association
study of the features with the conditions and produce an html file with
the visualisation of the features and the association result.</p>
<p>For this, we would first need to generate the features using
scFeatures and then store the result in a named list format.</p>
<p>For demonstration purpose, we provide an example of this features
list. The code below show a step to step guide of generating the hmtl
output from the features list.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here we use the demo data from the package </span></span>
<span><span class="va">scfeatures_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"scfeatures_result.rds"</span>, </span>
<span>                            package <span class="op">=</span> <span class="st">"scFeatures"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># here we use the current working directory to save the html output</span></span>
<span><span class="co"># modify this to save the html file to other directory</span></span>
<span><span class="va">output_folder</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_association_study_report.html">run_association_study_report</a></span><span class="op">(</span><span class="va">scfeatures_result</span>, <span class="va">output_folder</span> <span class="op">)</span></span></code></pre></div>
<p>Inside the directory defined in the <code>output_folder</code>, you
will see the html report output with the name
<code>output_report.html</code>.</p>
</div>
<div class="section level2">
<h2 id="some-additional-notes-on-creating-the-scfeatures_list">Some additional notes on creating the scfeatures_list<a class="anchor" aria-label="anchor" href="#some-additional-notes-on-creating-the-scfeatures_list"></a>
</h2>
<p>When generating the features using scFeatures, make sure the
<code>sample</code> information is in the format of
<code>a_cond_b</code>, where <code>a</code> is sample ID and
<code>b</code> is the condition, eg,
<code>patient09_cond_nonresponder</code>. This is so that we can
retrieve the sample ID and the corresponding condition when running the
analysis.</p>
<p>When creating the list, the name of the list must use the same name
as shown below. Otherwise, it is not possible to tell which feature type
each list entry is and create the correct visualisation for each feature
type.</p>
<p>Not all feature types need to be provided. If a feature type is
missing, the section in the html for the feature type will just be left
blank.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of creating the feature list using the correct naming conventions</span></span>
<span><span class="va">scfeatures_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span>
<span>   proportion_raw <span class="op">=</span> <span class="va">proportion_raw</span>,</span>
<span>   proportion_logit <span class="op">=</span>   <span class="va">proportion_logit</span>, </span>
<span>   proportion_ratio <span class="op">=</span> <span class="va">proportion_ratio</span>, </span>
<span>   gene_mean_celltype <span class="op">=</span> <span class="va">gene_mean_celltype</span>,</span>
<span>   gene_prop_celltype <span class="op">=</span> <span class="va">gene_prop_celltype</span>, </span>
<span>   gene_cor_celltype <span class="op">=</span> <span class="va">gene_cor_celltype</span>, </span>
<span>   pathway_gsva <span class="op">=</span> <span class="va">pathway_gsva</span> , </span>
<span>   pathway_mean <span class="op">=</span> <span class="va">pathway_mean</span>, </span>
<span>   pathway_prop <span class="op">=</span> <span class="va">pathway_prop</span>,</span>
<span>   CCI <span class="op">=</span> <span class="va">CCI</span> ,</span>
<span>   gene_mean_aggregated <span class="op">=</span> <span class="va">gene_mean_aggregated</span> , </span>
<span>   gene_cor_aggregated <span class="op">=</span> <span class="va">gene_cor_aggregated</span> , </span>
<span>   gene_prop_aggregated <span class="op">=</span> <span class="va">gene_prop_aggregated</span>,</span>
<span>   L_stats  <span class="op">=</span> <span class="va">L_stats</span> , </span>
<span>   morans_I <span class="op">=</span> <span class="va">morans_I</span>, </span>
<span>   celltype_interaction <span class="op">=</span> <span class="va">celltype_interaction</span>,</span>
<span>   nn_correlation <span class="op">=</span> <span class="va">nn_correlation</span></span>
<span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo()<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Debian GNU/Linux 11 (bullseye)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.13.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] BiocStyle_2.24.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] rstudioapi_0.14     knitr_1.40          magrittr_2.0.3     </span></span>
<span><span class="co">##  [4] R6_2.5.1            ragg_1.2.3          rlang_1.0.6        </span></span>
<span><span class="co">##  [7] fastmap_1.1.0       stringr_1.4.1       tools_4.2.1        </span></span>
<span><span class="co">## [10] xfun_0.33           cli_3.4.1           jquerylib_0.1.4    </span></span>
<span><span class="co">## [13] systemfonts_1.0.4   htmltools_0.5.3     yaml_2.3.5         </span></span>
<span><span class="co">## [16] digest_0.6.29       rprojroot_2.0.3     pkgdown_2.0.6      </span></span>
<span><span class="co">## [19] bookdown_0.30       textshaping_0.3.6   BiocManager_1.30.18</span></span>
<span><span class="co">## [22] purrr_0.3.5         sass_0.4.2          fs_1.5.2           </span></span>
<span><span class="co">## [25] memoise_2.0.1       cachem_1.0.6        evaluate_0.17      </span></span>
<span><span class="co">## [28] rmarkdown_2.17      stringi_1.7.8       compiler_4.2.1     </span></span>
<span><span class="co">## [31] bslib_0.4.0         desc_1.4.2          jsonlite_1.8.2</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Yue Cao, Yingxin Lin, Ellis Patrick, Pengyi Yang, Jean Yee Hwa Yang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
