<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An association study of features with conditions with scFeatures â€¢ scFeatures</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An association study of features with conditions with scFeatures">
<meta property="og:description" content="scFeatures">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">scFeatures</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/scFeatures_associationstudy.html">An association study of features with conditions with scFeatures</a>
    </li>
    <li>
      <a href="../articles/scFeatures_detail.html">A detailed explanation of scFeatures' features</a>
    </li>
    <li>
      <a href="../articles/scFeatures_summary.html">A summary of scFeatures functions</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="scFeatures_associationstudy_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An association study of features with conditions with scFeatures</h1>
            
      
      
      <div class="hidden name"><code>scFeatures_associationstudy.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="association-study-of-the-features-with-the-conditions">Association study of the features with the conditions<a class="anchor" aria-label="anchor" href="#association-study-of-the-features-with-the-conditions"></a>
</h2>
<p>scFeatures provides a function that automatically run association study of the features with the conditions and produce an html file with the visualisation of the features and the association result.</p>
<p>For this, we would first need to generate the features using scFeatures and then store the result in a named list format.</p>
<p>For demonstration purpose, we provide an example of this features list. The code below show a step to step guide of generating the hmtl output from the features list.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># here we use the demo data from the package </span></span>
<span><span class="va">scfeatures_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"scfeatures_result.rds"</span>,   </span>
<span>                            package <span class="op">=</span> <span class="st">"scFeatures"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># here we use the current working directory to save the html output</span></span>
<span><span class="co"># modify this to save the html file to other directory</span></span>
<span><span class="va">output_folder</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/run_association_study_report.html">run_association_study_report</a></span><span class="op">(</span><span class="va">scfeatures_result</span>, <span class="va">output_folder</span> <span class="op">)</span></span></code></pre></div>
<p>Inside the directory defined in the <code>output_folder</code>, you will see the html report output with the name <code>output_report.html</code>.</p>
</div>
<div class="section level2">
<h2 id="some-additional-notes-on-creating-the-scfeatures_list">Some additional notes on creating the scfeatures_list<a class="anchor" aria-label="anchor" href="#some-additional-notes-on-creating-the-scfeatures_list"></a>
</h2>
<p>When generating the features using scFeatures, make sure the <code>sample</code> information is in the format of <code>a_cond_b</code>, where <code>a</code> is sample ID and <code>b</code> is the condition, eg, <code>patient09_cond_nonresponder</code>. This is so that we can retrieve the sample ID and the corresponding condition when running the analysis.</p>
<p>When creating the list, the name of the list must use the same name as shown below. Otherwise, it is not possible to tell which feature type each list entry is and create the correct visualisation for each feature type.</p>
<p>Not all feature types need to be provided. If a feature type is missing, the section in the html for the feature type will just be left blank.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of creating the feature list using the correct naming conventions</span></span>
<span><span class="va">scfeatures_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> </span>
<span>   proportion_raw <span class="op">=</span> <span class="va">proportion_raw</span>,</span>
<span>   proportion_logit <span class="op">=</span>   <span class="va">proportion_logit</span>, </span>
<span>   proportion_ratio <span class="op">=</span> <span class="va">proportion_ratio</span>, </span>
<span>   gene_mean_celltype <span class="op">=</span> <span class="va">gene_mean_celltype</span>,</span>
<span>   gene_prop_celltype <span class="op">=</span> <span class="va">gene_prop_celltype</span>, </span>
<span>   gene_cor_celltype <span class="op">=</span> <span class="va">gene_cor_celltype</span>, </span>
<span>   pathway_gsva <span class="op">=</span> <span class="va">pathway_gsva</span> , </span>
<span>   pathway_mean <span class="op">=</span> <span class="va">pathway_mean</span>, </span>
<span>   pathway_prop <span class="op">=</span> <span class="va">pathway_prop</span>,</span>
<span>   CCI <span class="op">=</span> <span class="va">CCI</span> ,</span>
<span>   gene_mean_aggregated <span class="op">=</span> <span class="va">gene_mean_aggregated</span> , </span>
<span>   gene_cor_aggregated <span class="op">=</span> <span class="va">gene_cor_aggregated</span> , </span>
<span>   gene_prop_aggregated <span class="op">=</span> <span class="va">gene_prop_aggregated</span>,</span>
<span>   L_stats  <span class="op">=</span> <span class="va">L_stats</span> , </span>
<span>   morans_I <span class="op">=</span> <span class="va">morans_I</span>, </span>
<span>   celltype_interaction <span class="op">=</span> <span class="va">celltype_interaction</span>,</span>
<span>   nn_correlation <span class="op">=</span> <span class="va">nn_correlation</span></span>
<span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sessioninfo">sessionInfo()<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.2.1 (2022-06-23)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Debian GNU/Linux 11 (bullseye)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3</span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.13.so</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] scFeatures_0.99.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] rappdirs_0.3.3              rtracklayer_1.58.0         </span></span>
<span><span class="co">##   [3] scattermore_0.8             SpatialExperiment_1.8.0    </span></span>
<span><span class="co">##   [5] R.methodsS3_1.8.2           SeuratObject_4.1.3         </span></span>
<span><span class="co">##   [7] ragg_1.2.4                  tidyr_1.2.1                </span></span>
<span><span class="co">##   [9] ggplot2_3.4.0               bit64_4.0.5                </span></span>
<span><span class="co">##  [11] knitr_1.41                  irlba_2.3.5.1              </span></span>
<span><span class="co">##  [13] DelayedArray_0.24.0         R.utils_2.12.2             </span></span>
<span><span class="co">##  [15] data.table_1.14.4           KEGGREST_1.38.0            </span></span>
<span><span class="co">##  [17] RCurl_1.98-1.9              AnnotationFilter_1.22.0    </span></span>
<span><span class="co">##  [19] generics_0.1.3              BiocGenerics_0.44.0        </span></span>
<span><span class="co">##  [21] GenomicFeatures_1.50.2      ScaledMatrix_1.6.0         </span></span>
<span><span class="co">##  [23] cowplot_1.1.1               RSQLite_2.2.19             </span></span>
<span><span class="co">##  [25] EnsDb.Mmusculus.v79_2.99.0  RANN_2.6.1                 </span></span>
<span><span class="co">##  [27] future_1.29.0               bit_4.0.5                  </span></span>
<span><span class="co">##  [29] spatstat.data_3.0-0         xml2_1.3.3                 </span></span>
<span><span class="co">##  [31] httpuv_1.6.6                SummarizedExperiment_1.28.0</span></span>
<span><span class="co">##  [33] assertthat_0.2.1            xfun_0.35                  </span></span>
<span><span class="co">##  [35] hms_1.1.2                   jquerylib_0.1.4            </span></span>
<span><span class="co">##  [37] babelgene_22.9              evaluate_0.18              </span></span>
<span><span class="co">##  [39] promises_1.2.0.1            fansi_1.0.3                </span></span>
<span><span class="co">##  [41] restfulr_0.0.15             progress_1.2.2             </span></span>
<span><span class="co">##  [43] dbplyr_2.2.1                igraph_1.3.5               </span></span>
<span><span class="co">##  [45] DBI_1.1.3                   htmlwidgets_1.5.4          </span></span>
<span><span class="co">##  [47] spatstat.geom_3.0-3         stats4_4.2.1               </span></span>
<span><span class="co">##  [49] purrr_0.3.5                 ellipsis_0.3.2             </span></span>
<span><span class="co">##  [51] dplyr_1.0.10                annotate_1.76.0            </span></span>
<span><span class="co">##  [53] RcppParallel_5.1.5          biomaRt_2.54.0             </span></span>
<span><span class="co">##  [55] deldir_1.0-6                sparseMatrixStats_1.10.0   </span></span>
<span><span class="co">##  [57] MatrixGenerics_1.10.0       vctrs_0.5.1                </span></span>
<span><span class="co">##  [59] SingleCellExperiment_1.20.0 Biobase_2.58.0             </span></span>
<span><span class="co">##  [61] ensembldb_2.22.0            ROCR_1.0-11                </span></span>
<span><span class="co">##  [63] abind_1.4-5                 cachem_1.0.6               </span></span>
<span><span class="co">##  [65] progressr_0.11.0            sctransform_0.3.5          </span></span>
<span><span class="co">##  [67] GenomicAlignments_1.34.0    prettyunits_1.1.1          </span></span>
<span><span class="co">##  [69] goftest_1.2-3               cluster_2.1.4              </span></span>
<span><span class="co">##  [71] ape_5.6-2                   lazyeval_0.2.2             </span></span>
<span><span class="co">##  [73] crayon_1.5.2                spatstat.explore_3.0-5     </span></span>
<span><span class="co">##  [75] edgeR_3.40.0                pkgconfig_2.0.3            </span></span>
<span><span class="co">##  [77] GenomeInfoDb_1.34.4         nlme_3.1-160               </span></span>
<span><span class="co">##  [79] ProtGenerics_1.30.0         rlang_1.0.6                </span></span>
<span><span class="co">##  [81] globals_0.16.2              lifecycle_1.0.3            </span></span>
<span><span class="co">##  [83] miniUI_0.1.1.1              filelock_1.0.2             </span></span>
<span><span class="co">##  [85] BiocFileCache_2.6.0         rsvd_1.0.5                 </span></span>
<span><span class="co">##  [87] rprojroot_2.0.3             polyclip_1.10-4            </span></span>
<span><span class="co">##  [89] GSVA_1.46.0                 matrixStats_0.63.0         </span></span>
<span><span class="co">##  [91] lmtest_0.9-40               graph_1.76.0               </span></span>
<span><span class="co">##  [93] Matrix_1.5-3                Rhdf5lib_1.20.0            </span></span>
<span><span class="co">##  [95] zoo_1.8-11                  ggridges_0.5.4             </span></span>
<span><span class="co">##  [97] png_0.1-8                   viridisLite_0.4.1          </span></span>
<span><span class="co">##  [99] rjson_0.2.21                bitops_1.0-7               </span></span>
<span><span class="co">## [101] R.oo_1.25.0                 KernSmooth_2.23-20         </span></span>
<span><span class="co">## [103] rhdf5filters_1.10.0         Biostrings_2.66.0          </span></span>
<span><span class="co">## [105] blob_1.2.3                  DelayedMatrixStats_1.20.0  </span></span>
<span><span class="co">## [107] stringr_1.5.0               parallelly_1.32.1          </span></span>
<span><span class="co">## [109] spatstat.random_3.0-1       S4Vectors_0.36.0           </span></span>
<span><span class="co">## [111] beachmat_2.14.0             scales_1.2.1               </span></span>
<span><span class="co">## [113] memoise_2.0.1               GSEABase_1.60.0            </span></span>
<span><span class="co">## [115] magrittr_2.0.3              plyr_1.8.8                 </span></span>
<span><span class="co">## [117] ica_1.0-3                   zlibbioc_1.44.0            </span></span>
<span><span class="co">## [119] compiler_4.2.1              dqrng_0.3.0                </span></span>
<span><span class="co">## [121] BiocIO_1.8.0                RColorBrewer_1.1-3         </span></span>
<span><span class="co">## [123] fitdistrplus_1.1-8          Rsamtools_2.14.0           </span></span>
<span><span class="co">## [125] cli_3.4.1                   XVector_0.38.0             </span></span>
<span><span class="co">## [127] listenv_0.8.0               EnsDb.Hsapiens.v79_2.99.0  </span></span>
<span><span class="co">## [129] patchwork_1.1.2             pbapply_1.6-0              </span></span>
<span><span class="co">## [131] MASS_7.3-58.1               tidyselect_1.2.0           </span></span>
<span><span class="co">## [133] stringi_1.7.8               textshaping_0.3.6          </span></span>
<span><span class="co">## [135] yaml_2.3.6                  BiocSingular_1.14.0        </span></span>
<span><span class="co">## [137] locfit_1.5-9.6              ggrepel_0.9.2              </span></span>
<span><span class="co">## [139] grid_4.2.1                  sass_0.4.3                 </span></span>
<span><span class="co">## [141] tools_4.2.1                 future.apply_1.10.0        </span></span>
<span><span class="co">## [143] parallel_4.2.1              AUCell_1.20.1              </span></span>
<span><span class="co">## [145] gridExtra_2.3               Rtsne_0.16                 </span></span>
<span><span class="co">## [147] DropletUtils_1.18.0         proxyC_0.3.3               </span></span>
<span><span class="co">## [149] digest_0.6.30               shiny_1.7.3                </span></span>
<span><span class="co">## [151] Rcpp_1.0.9                  GenomicRanges_1.50.1       </span></span>
<span><span class="co">## [153] scuttle_1.8.0               later_1.3.0                </span></span>
<span><span class="co">## [155] RcppAnnoy_0.0.20            httr_1.4.4                 </span></span>
<span><span class="co">## [157] AnnotationDbi_1.60.0        colorspace_2.0-3           </span></span>
<span><span class="co">## [159] XML_3.99-0.13               fs_1.5.2                   </span></span>
<span><span class="co">## [161] tensor_1.5                  reticulate_1.26            </span></span>
<span><span class="co">## [163] IRanges_2.32.0              splines_4.2.1              </span></span>
<span><span class="co">## [165] uwot_0.1.14                 spatstat.utils_3.0-1       </span></span>
<span><span class="co">## [167] pkgdown_2.0.6               sp_1.5-1                   </span></span>
<span><span class="co">## [169] plotly_4.10.1               systemfonts_1.0.4          </span></span>
<span><span class="co">## [171] xtable_1.8-4                jsonlite_1.8.3             </span></span>
<span><span class="co">## [173] R6_2.5.1                    pillar_1.8.1               </span></span>
<span><span class="co">## [175] htmltools_0.5.3             mime_0.12                  </span></span>
<span><span class="co">## [177] glue_1.6.2                  fastmap_1.1.0              </span></span>
<span><span class="co">## [179] BiocParallel_1.32.4         codetools_0.2-18           </span></span>
<span><span class="co">## [181] utf8_1.2.2                  lattice_0.20-45            </span></span>
<span><span class="co">## [183] bslib_0.4.1                 spatstat.sparse_3.0-0      </span></span>
<span><span class="co">## [185] tibble_3.1.8                curl_4.3.3                 </span></span>
<span><span class="co">## [187] leiden_0.4.3                gtools_3.9.3               </span></span>
<span><span class="co">## [189] magick_2.7.3                survival_3.4-0             </span></span>
<span><span class="co">## [191] limma_3.54.0                rmarkdown_2.18             </span></span>
<span><span class="co">## [193] desc_1.4.2                  munsell_0.5.0              </span></span>
<span><span class="co">## [195] rhdf5_2.42.0                GenomeInfoDbData_1.2.9     </span></span>
<span><span class="co">## [197] HDF5Array_1.26.0            reshape2_1.4.4             </span></span>
<span><span class="co">## [199] gtable_0.3.1                msigdbr_7.5.1              </span></span>
<span><span class="co">## [201] Seurat_4.3.0</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yue Cao, Yingxin Lin, Ellis Patrick, Pengyi Yang, Jean Yee Hwa Yang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
